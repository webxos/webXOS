<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vial2 MCP Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module" src="/mcp/client/terminal_commands.js"></script>
    <style>
        body { font-family: monospace; background-color: #1a1a1a; color: #ffffff; }
        #terminal { height: 80vh; overflow-y: auto; background-color: #2d2d2d; padding: 1rem; }
        #input { width: 100%; background-color: #3d3d3d; color: #ffffff; border: none; padding: 0.5rem; }
        .button { padding: 0.5rem 1rem; margin: 0.5rem; }
    </style>
</head>
<body>
    <div class="p-4">
        <div class="flex space-x-4 mb-4">
            <button id="authButton" class="button bg-blue-600 hover:bg-blue-700">Authenticate (OAuth2.0)</button>
            <button id="apiAccessButton" class="button bg-green-600 hover:bg-green-700">API Access</button>
            <button id="mineButton" class="button bg-purple-600 hover:bg-purple-700">Mine Proof of Work</button>
            <button id="walletButton" class="button bg-yellow-600 hover:bg-yellow-700">Wallet Status</button>
        </div>
        <div id="status" class="mb-4">Status: Disconnected</div>
        <div id="terminal" class="rounded"></div>
        <input id="input" type="text" placeholder="Enter command (/help for commands)">
    </div>
    <script type="module">
        import { handleTerminalCommand } from '/mcp/client/terminal_commands.js';

        const terminal = document.getElementById('terminal');
        const input = document.getElementById('input');
        const status = document.getElementById('status');
        let isAuthenticated = false;

        async function log(message) {
            terminal.innerHTML += `<div>${message}</div>`;
            terminal.scrollTop = terminal.scrollHeight;
        }

        document.getElementById('authButton').addEventListener('click', async () => {
            try {
                const response = await axios.get('/mcp/auth');
                localStorage.setItem('token', response.data.token);
                isAuthenticated = true;
                status.textContent = 'Status: Authenticated';
                log('Authentication successful');
            } catch (e) {
                log(`Authentication failed: ${e.response?.data?.error?.message || e.message}`);
            }
        });

        document.getElementById('apiAccessButton').addEventListener('click', async () => {
            if (!isAuthenticated) {
                log('Please authenticate first using /auth');
                return;
            }
            try {
                const response = await axios.post('/mcp/api/vial/api_key/generate', { vial_id: 'vial1' }, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                log(`API Access Key: ${JSON.stringify(response.data.result.data, null, 2)}`);
            } catch (e) {
                log(`API Access failed: ${e.response?.data?.error?.message || e.message}`);
            }
        });

        document.getElementById('mineButton').addEventListener('click', async () => {
            if (!isAuthenticated) {
                log('Please authenticate first using /auth');
                return;
            }
            log('Initiating proof-of-work mining...');
            // Mining logic to be implemented
        });

        document.getElementById('walletButton').addEventListener('click', async () => {
            if (!isAuthenticated) {
                log('Please authenticate first using /auth');
                return;
            }
            try {
                const response = await axios.post('/mcp/api/vial/wallet/sync', { vial_id: 'vial1' }, {
                    headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }
                });
                log(`Wallet Status: ${JSON.stringify(response.data.result.data, null, 2)}`);
            } catch (e) {
                log(`Wallet Status failed: ${e.response?.data?.error?.message || e.message}`);
            }
        });

        input.addEventListener('keypress', async (e) => {
            if (e.key === 'Enter' && input.value.trim()) {
                await handleTerminalCommand(input.value, log);
                input.value = '';
            }
        });

        // Check for OAuth redirect token
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');
        if (token) {
            localStorage.setItem('token', token);
            isAuthenticated = true;
            status.textContent = 'Status: Authenticated';
            log('Authenticated via OAuth2.0 redirect');
        }
    </script>
</body>
</html>

# xAI Artifact Tags: #vial2 #html #mcp #inspector #oauth2 #git #neon_mcp
