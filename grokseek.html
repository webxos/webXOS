<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GROKSEEK BETA v1.1</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --deepseek-blue: #0A1F3D;
            --grok-dark: #0B0E17;
            --neon-blue: #00D4FF;
            --pixel-gray: #1E1E1E;
            --light-gray: #2D2D2D;
            --medium-gray: #3A3A3A;
            --win95-border: #7A7A7A;
            --error-red: #FF3366;
            --success-green: #00FF88;
            --folder-yellow: #FFC107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: var(--grok-dark);
            color: #e0e0e0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* === LOADING SCREEN === */
        .loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--grok-dark);
            display: flex; align-items: center; justify-content: center;
            z-index: 9999; flex-direction: column;
            font-size: 1.2rem;
            text-align: center;
        }

        .loading-screen.hidden { 
            display: none; 
        }

        .loading-bar {
            width: 300px; height: 4px;
            background: var(--light-gray);
            margin-top: 20px;
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-fill {
            width: 0%; height: 100%;
            background: var(--neon-blue);
            box-shadow: 0 0 10px var(--neon-blue);
            transition: width 0.3s;
        }

        .neural-pulse {
            width: 60px; height: 60px;
            border: 3px solid var(--neon-blue);
            border-radius: 50%;
            position: relative;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .neural-pulse::before {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            width: 20px; height: 20px;
            background: var(--neon-blue);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 15px var(--neon-blue);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 212, 255, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(0, 212, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 212, 255, 0); }
        }

        /* === TASKBAR === */
        .taskbar {
            height: 32px;
            background: var(--pixel-gray);
            border-top: 1px solid #fff;
            display: flex;
            align-items: center;
            padding: 0 4px;
            box-shadow: 0 -1px 3px rgba(0,0,0,0.5);
        }

        .start-btn {
            background: var(--deepseek-blue);
            border: 1px outset var(--neon-blue);
            padding: 2px 12px;
            font-weight: bold;
            color: var(--neon-blue);
            cursor: pointer;
            margin-right: 8px;
            font-size: 0.9rem;
        }

        .start-btn:active {
            border: 1px inset var(--neon-blue);
        }

        .taskbar-icons {
            display: flex;
            gap: 4px;
            flex-grow: 1;
        }

        .task-icon {
            width: 24px; height: 24px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--neon-blue);
        }

        .task-icon.active {
            background: var(--neon-blue);
            color: black;
        }

        .clock {
            margin-left: auto;
            font-size: 0.8rem;
            padding: 0 8px;
        }

        /* === DESKTOP === */
        .desktop {
            flex: 1;
            padding: 8px;
            overflow: auto;
            position: relative;
            background: var(--grok-dark);
        }

        .desktop-icon {
            width: 80px;
            text-align: center;
            margin: 8px;
            cursor: pointer;
            font-size: 0.75rem;
            color: #ccc;
            transition: all 0.2s;
        }

        .desktop-icon:hover {
            color: var(--neon-blue);
            background: rgba(0, 212, 255, 0.1);
            border-radius: 4px;
        }

        .desktop-icon i {
            font-size: 32px;
            display: block;
            margin-bottom: 4px;
            filter: drop-shadow(0 0 3px var(--neon-blue));
        }

        .desktop-icon.folder i {
            color: var(--folder-yellow);
            filter: drop-shadow(0 0 3px var(--folder-yellow));
        }

        /* === WINDOWS === */
        .win95-window {
            position: absolute;
            background: var(--pixel-gray);
            border: 2px solid var(--win95-border);
            border-top-color: #fff;
            border-left-color: #fff;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.8);
            min-width: 400px;
            min-height: 300px;
            display: none;
            flex-direction: column;
            max-width: 90vw;
            max-height: 80vh;
        }

        .win95-window.active {
            display: flex;
            z-index: 100;
        }

        .win95-window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - 32px) !important;
            max-width: 100vw;
            max-height: calc(100vh - 32px);
        }

        .title-bar {
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            padding: 3px 6px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            user-select: none;
        }

        .title-bar button {
            width: 16px; height: 14px;
            background: var(--pixel-gray);
            border: 1px solid #fff;
            font-size: 10px;
            text-align: center;
            line-height: 10px;
            margin-left: 2px;
            cursor: pointer;
        }

        .window-content {
            flex: 1;
            padding: 10px;
            overflow: auto;
            background: var(--grok-dark);
            display: flex;
            flex-direction: column;
        }

        /* === SCROLLBARS === */
        .window-content::-webkit-scrollbar {
            width: 16px;
        }

        .window-content::-webkit-scrollbar-track {
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
        }

        .window-content::-webkit-scrollbar-thumb {
            background: var(--medium-gray);
            border: 1px solid var(--win95-border);
        }

        .window-content::-webkit-scrollbar-thumb:hover {
            background: var(--neon-blue);
        }

        /* === GROKSEEK TERMINAL === */
        .terminal {
            height: 100%;
            display: flex;
            flex-direction: column;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .terminal-output {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
            background: black;
            color: #0f0;
            border: 1px solid var(--light-gray);
        }

        .terminal-line {
            margin-bottom: 4px;
            white-space: pre-wrap;
        }

        .terminal-line.error { color: var(--error-red); }
        .terminal-line.success { color: var(--success-green); }
        .terminal-line.suggestion { color: var(--neon-blue); font-style: italic; }

        .terminal-input-line {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            background: var(--deepseek-blue);
            border-top: 1px solid var(--light-gray);
        }

        .prompt {
            color: var(--neon-blue);
            margin-right: 8px;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        /* === BLUETOOTH MESH PANEL === */
        .bt-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .bt-device {
            padding: 8px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .bt-device.connected {
            background: #001f3f;
            color: var(--neon-blue);
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 5px var(--neon-blue);
        }

        .bt-device:hover {
            background: var(--medium-gray);
        }

        .bt-status {
            display: inline-block;
            width: 8px; height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .bt-status.on { background: var(--success-green); box-shadow: 0 0 5px var(--success-green); }
        .bt-status.off { background: #666; }
        .bt-status.pairing { 
            background: var(--neon-blue); 
            box-shadow: 0 0 5px var(--neon-blue);
            animation: pulse 1.5s infinite;
        }

        /* === GIT PUSH CONTROLS === */
        .git-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .git-input {
            display: flex;
            gap: 8px;
        }

        .git-input input {
            flex: 1;
            padding: 6px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
        }

        .git-btn {
            padding: 6px 12px;
            background: var(--deepseek-blue);
            border: 1px solid var(--neon-blue);
            color: var(--neon-blue);
            cursor: pointer;
            font-family: 'Courier New', monospace;
            transition: all 0.2s;
        }

        .git-btn:hover {
            background: var(--neon-blue);
            color: black;
        }

        /* === API WIZARD === */
        .api-wizard {
            margin-top: 10px;
            padding: 10px;
            background: var(--deepseek-blue);
            border: 1px dashed var(--neon-blue);
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .api-step {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .api-step input {
            flex: 1;
            padding: 4px;
            background: var(--grok-dark);
            border: 1px solid var(--medium-gray);
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
        }

        /* === FILE BROWSER === */
        .file-browser {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .file-toolbar {
            display: flex;
            gap: 8px;
            padding: 6px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            margin-bottom: 8px;
        }

        .file-toolbar button {
            padding: 4px 8px;
            background: var(--deepseek-blue);
            border: 1px solid var(--neon-blue);
            color: var(--neon-blue);
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }

        .file-toolbar button:hover {
            background: var(--neon-blue);
            color: black;
        }

        .file-path {
            padding: 4px 8px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            margin-bottom: 8px;
            font-size: 0.8rem;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            overflow-y: auto;
            flex: 1;
            padding: 8px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
        }

        .file-item {
            text-align: center;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: 0.75rem;
        }

        .file-item:hover {
            background: var(--medium-gray);
        }

        .file-item.selected {
            background: var(--neon-blue);
            color: black;
        }

        .file-item i {
            font-size: 24px;
            margin-bottom: 4px;
            display: block;
        }

        .file-item.folder i {
            color: var(--folder-yellow);
        }

        .file-item.file i {
            color: var(--neon-blue);
        }

        /* === GUIDE WINDOW === */
        .guide-content {
            height: 100%;
            overflow-y: auto;
            padding: 8px;
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
        }

        .guide-section {
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--medium-gray);
        }

        .guide-section h3 {
            color: var(--neon-blue);
            margin-bottom: 8px;
        }

        .guide-section p {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .guide-section code {
            background: var(--deepseek-blue);
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: var(--neon-blue);
        }

        /* === NEON GLOW === */
        .neon-glow { box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue); }
        .neon-border { border: 1px solid var(--neon-blue); box-shadow: 0 0 8px var(--neon-blue); }
        .neon-text { color: var(--neon-blue); text-shadow: 0 0 5px var(--neon-blue); }

        /* === RESPONSIVE TOUCH === */
        @media (max-width: 768px) {
            .bt-panel { grid-template-columns: 1fr; }
            .desktop-icon { width: 60px; font-size: 0.7rem; }
            .desktop-icon i { font-size: 28px; }
            .file-grid { grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); }
        }
    </style>
</head>
<body>

    <!-- LOADING SCREEN -->
    <div class="loading-screen" id="loadingScreen">
        <div class="neural-pulse"></div>
        <div>GROKSEEK BETA v1.1 Initializing...</div>
        <div class="loading-bar"><div class="loading-fill" id="loadingFill"></div></div>
    </div>

    <!-- TASKBAR -->
    <div class="taskbar" id="taskbar" style="display: none;">
        <button class="start-btn" id="startBtn">GROKSEEK BETA v1.1</button>
        <div class="taskbar-icons">
            <div class="task-icon active" id="terminalIcon"><i class="fas fa-terminal"></i></div>
            <div class="task-icon" id="btIcon"><i class="fas fa-bluetooth"></i></div>
            <div class="task-icon" id="gitIcon"><i class="fas fa-code-branch"></i></div>
            <div class="task-icon" id="apiIcon"><i class="fas fa-plug"></i></div>
            <div class="task-icon" id="browseIcon"><i class="fas fa-folder"></i></div>
            <div class="task-icon" id="guideIcon"><i class="fas fa-book"></i></div>
        </div>
        <div class="clock" id="clock"></div>
    </div>

    <!-- DESKTOP -->
    <div class="desktop" id="desktop" style="display: none;">
        <div class="desktop-icon" id="openTerminal">
            <i class="fas fa-terminal"></i>
            <div>GROKSEEK Agent</div>
        </div>
        <div class="desktop-icon" id="openBT">
            <i class="fas fa-bluetooth-b"></i>
            <div>Bluetooth Mesh</div>
        </div>
        <div class="desktop-icon" id="openGit">
            <i class="fas fa-code-branch"></i>
            <div>Git Push</div>
        </div>
        <div class="desktop-icon" id="openAPI">
            <i class="fas fa-cloud"></i>
            <div>API Wizard</div>
        </div>
        <div class="desktop-icon folder" id="openBrowse">
            <i class="fas fa-folder"></i>
            <div>X: Drive Browser</div>
        </div>
        <div class="desktop-icon folder" id="openGuide">
            <i class="fas fa-book"></i>
            <div>GROKSEEK Guide</div>
        </div>
    </div>

    <!-- GROKSEEK TERMINAL WINDOW -->
    <div class="win95-window" id="terminalWindow">
        <div class="title-bar">
            <span>GROKSEEK v1.1 Agent Terminal</span>
            <div>
                <button id="minTerminal">_</button>
                <button id="maxTerminal">□</button>
                <button id="closeTerminal">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="terminal">
                <div class="terminal-output" id="terminalOutput">
                    <div class="terminal-line">GROKSEEK BETA v1.1 - UNDER DEVELOPMENT (GUI ONLY)</div>
                    <div class="terminal-line">GROK + DEEPSEEK = GROKSEEK</div>
                    <div class="terminal-line success">Network: READY | Git: READY | API: OFFLINE</div>
                    <div class="terminal-line">Type 'help' for commands</div>
                </div>
                <div class="terminal-input-line">
                    <span class="prompt">></span>
                    <input type="text" class="terminal-input" id="terminalInput" autocomplete="off" autofocus>
                </div>
            </div>
        </div>
    </div>

    <!-- BLUETOOTH MESH ADMIN -->
    <div class="win95-window" id="btWindow">
        <div class="title-bar">
            <span>Bluetooth Mesh Network</span>
            <div>
                <button id="minBT">_</button>
                <button id="maxBT">□</button>
                <button id="closeBT">×</button>
            </div>
        </div>
        <div class="window-content">
            <div style="margin-bottom: 10px;">
                <strong>Mesh Status:</strong> <span id="meshStatus" class="neon-text">SCANNING...</span>
            </div>
            <div class="bt-panel" id="btDevices"></div>
            <div style="display: flex; gap: 8px; margin-top: 10px;">
                <button class="git-btn" style="flex: 1;" id="scanBT">SCAN NETWORK</button>
                <button class="git-btn" style="flex: 1;" id="btMesh">ENABLE MESH</button>
            </div>
            <div id="btLog" style="margin-top: 10px; font-size: 0.8rem; max-height: 100px; overflow: auto; background: black; padding: 8px; color: #0f0;"></div>
        </div>
    </div>

    <!-- GIT PUSH CONTROL -->
    <div class="win95-window" id="gitWindow">
        <div class="title-bar">
            <span>Git Push Control</span>
            <div>
                <button id="minGit">_</button>
                <button id="maxGit">□</button>
                <button id="closeGit">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="git-controls">
                <div class="git-input">
                    <input type="text" id="gitRepo" placeholder="git@github.com:user/repo.git">
                    <button class="git-btn" id="gitPush">PUSH</button>
                </div>
                <div class="git-input">
                    <input type="text" id="gitBranch" placeholder="main" value="main">
                    <button class="git-btn" id="gitPull">PULL</button>
                </div>
                <div id="gitLog" style="margin-top: 10px; font-size: 0.8rem; max-height: 150px; overflow: auto; background: black; padding: 8px; color: #0f0;"></div>
            </div>
        </div>
    </div>

    <!-- API WIZARD -->
    <div class="win95-window" id="apiWindow">
        <div class="title-bar">
            <span>API Connection Wizard</span>
            <div>
                <button id="minAPI">_</button>
                <button id="maxAPI">□</button>
                <button id="closeAPI">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="api-wizard">
                <div class="api-step">
                    <span>1. API URL:</span>
                    <input type="text" id="apiUrl" placeholder="https://api.grok.com/v1">
                </div>
                <div class="api-step">
                    <span>2. API Key:</span>
                    <input type="password" id="apiKey" placeholder="sk-...">
                </div>
                <div class="api-step">
                    <span>3. Model:</span>
                    <select id="apiModel" style="flex:1;padding:4px;background:var(--grok-dark);border:1px solid var(--medium-gray);color:#e0e0e0;">
                        <option>grok-beta</option>
                        <option>deepseek-coder</option>
                        <option>hybrid-grokseek</option>
                    </select>
                </div>
                <button class="git-btn" style="width:100%;margin-top:10px;" id="connectAPI">CONNECT</button>
                <div id="apiStatus" style="margin-top:10px; text-align:center; font-weight:bold;"></div>
            </div>
        </div>
    </div>

    <!-- FILE BROWSER -->
    <div class="win95-window" id="browseWindow">
        <div class="title-bar">
            <span>X: Drive Browser</span>
            <div>
                <button id="minBrowse">_</button>
                <button id="maxBrowse">□</button>
                <button id="closeBrowse">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="file-browser">
                <div class="file-toolbar">
                    <button id="newFolder"><i class="fas fa-folder-plus"></i> New Folder</button>
                    <button id="uploadFile"><i class="fas fa-upload"></i> Upload</button>
                    <button id="deleteFile"><i class="fas fa-trash"></i> Delete</button>
                    <button id="refreshFiles"><i class="fas fa-sync"></i> Refresh</button>
                </div>
                <div class="file-path" id="filePath">X:\</div>
                <div class="file-grid" id="fileGrid">
                    <!-- Files will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- GUIDE WINDOW -->
    <div class="win95-window" id="guideWindow">
        <div class="title-bar">
            <span>GROKSEEK OS Guide</span>
            <div>
                <button id="minGuide">_</button>
                <button id="maxGuide">□</button>
                <button id="closeGuide">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="guide-content" id="guideContent">
                <div class="guide-section">
                    <h3>Getting Started</h3>
                    <p>Welcome to GROKSEEK OS (UNDER DEVELOPMENT - this is a GUI for a hybrid AI operating system for Arduino/ESP32 devices. Designed to run Locally: Download the files below.</p>
                    <p>https://github.com/webxos/webXOS/blob/main/grokseek_readme.md</p>
                    <p>https://github.com/webxos/webXOS/blob/main/grokseek.html</p>
                </div>
                <div class="guide-section">
                    <h3>Terminal Commands</h3>
                    <p><code>help</code> - Show available commands</p>
                    <p><code>status</code> - Check system status</p>
                    <p><code>clear</code> - Clear terminal</p>
                    <p><code>git push &lt;repo&gt;</code> - Push to git repository</p>
                    <p><code>bt scan</code> - Scan for Bluetooth devices</p>
                    <p><code>api connect</code> - Connect to AI API</p>
                </div>
                <div class="guide-section">
                    <h3>Bluetooth Mesh</h3>
                    <p>Connect multiple ESP32 devices in a mesh network for distributed computing.</p>
                    <p>Devices automatically share AI processing tasks and data across the network.</p>
                </div>
                <div class="guide-section">
                    <h3>File System</h3>
                    <p>The X: drive represents your Arduino's flash storage where webpages and data are stored.</p>
                    <p>Use the File Browser to manage files directly on your device.</p>
                </div>
                <div class="guide-section">
                    <h3>ESP32 Setup</h3>
                    <p>1. Upload this HTML to SPIFFS using Arduino IDE</p>
                    <p>2. Add WebServer and BLE libraries</p>
                    <p>3. Configure WiFi or use Bluetooth-only mode</p>
                    <p>4. Access via IP address or BLE service</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === LOADING ANIMATION ===
        document.addEventListener('DOMContentLoaded', function() {
            const loadingFill = document.getElementById('loadingFill');
            const loadingScreen = document.getElementById('loadingScreen');
            const taskbar = document.getElementById('taskbar');
            const desktop = document.getElementById('desktop');
            
            let loadProgress = 0;
            const loadInterval = setInterval(() => {
                loadProgress += 2;
                loadingFill.style.width = loadProgress + '%';
                if (loadProgress >= 100) {
                    clearInterval(loadInterval);
                    setTimeout(() => {
                        loadingScreen.classList.add('hidden');
                        taskbar.style.display = 'flex';
                        desktop.style.display = 'flex';
                        initializeOS();
                    }, 500);
                }
            }, 30);
        });

        // === CLOCK ===
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('clock').textContent = time;
        }

        // === WINDOW MANAGEMENT ===
        function initializeOS() {
            // Start clock
            setInterval(updateClock, 1000);
            updateClock();

            const windows = {
                terminal: document.getElementById('terminalWindow'),
                bt: document.getElementById('btWindow'),
                git: document.getElementById('gitWindow'),
                api: document.getElementById('apiWindow'),
                browse: document.getElementById('browseWindow'),
                guide: document.getElementById('guideWindow')
            };

            // Window control functions
            function setupWindowControls(winId, minBtnId, maxBtnId, closeBtnId) {
                document.getElementById(minBtnId).onclick = () => windows[winId].classList.remove('active');
                document.getElementById(maxBtnId).onclick = () => windows[winId].classList.toggle('maximized');
                document.getElementById(closeBtnId).onclick = () => {
                    windows[winId].classList.remove('active');
                    windows[winId].classList.remove('maximized');
                };
            }

            // Setup window controls
            setupWindowControls('terminal', 'minTerminal', 'maxTerminal', 'closeTerminal');
            setupWindowControls('bt', 'minBT', 'maxBT', 'closeBT');
            setupWindowControls('git', 'minGit', 'maxGit', 'closeGit');
            setupWindowControls('api', 'minAPI', 'maxAPI', 'closeAPI');
            setupWindowControls('browse', 'minBrowse', 'maxBrowse', 'closeBrowse');
            setupWindowControls('guide', 'minGuide', 'maxGuide', 'closeGuide');

            function openWindow(win) {
                Object.values(windows).forEach(w => {
                    w.classList.remove('active');
                    w.classList.remove('maximized');
                });
                win.classList.add('active');
                win.style.left = Math.random() * 200 + 'px';
                win.style.top = Math.random() * 100 + 'px';
            }

            // Desktop icons
            document.getElementById('openTerminal').onclick = () => openWindow(windows.terminal);
            document.getElementById('openBT').onclick = () => openWindow(windows.bt);
            document.getElementById('openGit').onclick = () => openWindow(windows.git);
            document.getElementById('openAPI').onclick = () => openWindow(windows.api);
            document.getElementById('openBrowse').onclick = () => {
                openWindow(windows.browse);
                populateFileBrowser();
            };
            document.getElementById('openGuide').onclick = () => openWindow(windows.guide);

            // Taskbar icons
            document.getElementById('terminalIcon').onclick = () => openWindow(windows.terminal);
            document.getElementById('btIcon').onclick = () => openWindow(windows.bt);
            document.getElementById('gitIcon').onclick = () => openWindow(windows.git);
            document.getElementById('apiIcon').onclick = () => openWindow(windows.api);
            document.getElementById('browseIcon').onclick = () => {
                openWindow(windows.browse);
                populateFileBrowser();
            };
            document.getElementById('guideIcon').onclick = () => openWindow(windows.guide);

            // === DRAG WINDOWS ===
            document.querySelectorAll('.title-bar').forEach(bar => {
                let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                let isMaximized = false;
                
                bar.onmousedown = e => {
                    if (e.target.tagName === 'BUTTON') return;
                    e.preventDefault();
                    
                    // Store if window is maximized before drag
                    isMaximized = bar.parentElement.classList.contains('maximized');
                    if (isMaximized) {
                        bar.parentElement.classList.remove('maximized');
                        // Set position based on mouse position
                        bar.parentElement.style.left = (e.clientX - bar.parentElement.offsetWidth/2) + 'px';
                        bar.parentElement.style.top = e.clientY + 'px';
                    }
                    
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    document.onmouseup = () => {
                        document.onmouseup = null;
                        document.onmousemove = null;
                    };
                    document.onmousemove = elementDrag;
                };
                
                function elementDrag(e) {
                    e.preventDefault();
                    pos1 = pos3 - e.clientX;
                    pos2 = pos4 - e.clientY;
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    const win = bar.parentElement;
                    win.style.top = (win.offsetTop - pos2) + "px";
                    win.style.left = (win.offsetLeft - pos1) + "px";
                }
            });

            // === GROKSEEK AGENT TERMINAL ===
            const terminalInput = document.getElementById('terminalInput');
            const terminalOutput = document.getElementById('terminalOutput');

            function addLine(text, type = '') {
                const line = document.createElement('div');
                line.className = 'terminal-line';
                if (type) line.classList.add(type);
                line.textContent = text;
                terminalOutput.appendChild(line);
                terminalOutput.scrollTop = terminalOutput.scrollHeight;
            }

            function addSuggestions(cmd) {
                const suggestions = getSuggestions(cmd);
                suggestions.forEach(s => addLine(`  → ${s}`, 'suggestion'));
            }

            function getSuggestions(cmd) {
                const map = {
                    '': ['help', 'status', 'clear', 'git push', 'bt scan'],
                    'help': ['status', 'git', 'bt', 'api', 'draw', 'write'],
                    'git': ['git push <repo>', 'git pull', 'git status'],
                    'bt': ['bt scan', 'bt connect <id>', 'bt mesh on'],
                    'api': ['api connect', 'api test', 'api model grok-beta'],
                    'draw': ['draw line', 'draw circle', 'draw clear'],
                    'write': ['write "hello"', 'write file index.html']
                };
                return map[cmd.split(' ')[0]] || ['No suggestions'];
            }

            terminalInput.addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    const cmd = terminalInput.value.trim();
                    addLine(`> ${cmd}`);
                    terminalInput.value = '';
                    processCommand(cmd);
                }
            });

            function processCommand(cmd) {
                if (!cmd) return;

                const [action, ...args] = cmd.split(' ');

                try {
                    switch (action) {
                        case 'help':
                            addLine('Available: help, status, clear, git, bt, api, draw, write');
                            addSuggestions('help');
                            break;
                        case 'status':
                            addLine('GROKSEEK: ONLINE | BT: READY | GIT: READY | API: OFFLINE', 'success');
                            break;
                        case 'clear':
                            terminalOutput.innerHTML = '';
                            break;
                        case 'git':
                            addLine(`Git command: ${args.join(' ')}`, 'success');
                            addSuggestions('git');
                            break;
                        case 'bt':
                            addLine(`BT command: ${args.join(' ')}`, 'success');
                            addSuggestions('bt');
                            break;
                        case 'api':
                            addLine(`API command: ${args.join(' ')}`, 'success');
                            addSuggestions('api');
                            break;
                        case 'draw':
                            addLine(`Drawing: ${args.join(' ')}`, 'success');
                            break;
                        case 'write':
                            addLine(`Writing: ${args.join(' ')}`, 'success');
                            break;
                        default:
                            throw new Error(`Unknown command: ${action}`);
                    }
                } catch (err) {
                    addLine(`ERROR: ${err.message}`, 'error');
                    addSuggestions(action);
                }
            }

            // === BLUETOOTH MESH SIMULATION ===
            let btScanInterval;
            document.getElementById('scanBT').onclick = () => {
                // Clear any existing interval
                if (btScanInterval) clearInterval(btScanInterval);
                
                const devices = document.getElementById('btDevices');
                devices.innerHTML = '';
                const btLog = document.getElementById('btLog');
                btLog.innerHTML = '';
                
                // Start scanning animation
                document.getElementById('meshStatus').textContent = 'SCANNING...';
                document.getElementById('meshStatus').style.color = 'var(--neon-blue)';
                
                // Simulate real-time scanning
                btScanInterval = setInterval(() => {
                    const names = ['ESP32-Node1', 'ESP32-Node2', 'Phone', 'Tablet', 'Sensor-01'];
                    const randomDevice = names[Math.floor(Math.random() * names.length)];
                    
                    // Add log entry
                    const logEntry = document.createElement('div');
                    logEntry.textContent = `[${new Date().toLocaleTimeString()}] Found: ${randomDevice}`;
                    btLog.appendChild(logEntry);
                    btLog.scrollTop = btLog.scrollHeight;
                    
                    // Add device if not already added
                    if (!Array.from(devices.children).some(child => child.textContent.includes(randomDevice))) {
                        const div = document.createElement('div');
                        div.className = 'bt-device';
                        div.innerHTML = `<span class="bt-status pairing"></span>${randomDevice}`;
                        div.onclick = () => {
                            div.classList.toggle('connected');
                            const status = div.querySelector('.bt-status');
                            if (div.classList.contains('connected')) {
                                status.className = 'bt-status on';
                                addLine(`BT: Connected to ${randomDevice}`, 'success');
                            } else {
                                status.className = 'bt-status off';
                                addLine(`BT: Disconnected from ${randomDevice}`, 'error');
                            }
                        };
                        devices.appendChild(div);
                    }
                    
                    // Stop after finding 5 devices
                    if (devices.children.length >= 5) {
                        clearInterval(btScanInterval);
                        document.getElementById('meshStatus').textContent = '5 DEVICES FOUND';
                        document.getElementById('meshStatus').style.color = 'var(--success-green)';
                    }
                }, 800);
            };

            document.getElementById('btMesh').onclick = () => {
                const status = document.getElementById('meshStatus');
                if (status.textContent.includes('MESH')) {
                    status.textContent = 'MESH DISABLED';
                    status.style.color = 'var(--error-red)';
                    addLine('BT: Mesh network disabled', 'error');
                } else {
                    status.textContent = 'MESH ENABLED';
                    status.style.color = 'var(--success-green)';
                    addLine('BT: Mesh network enabled', 'success');
                }
            };

            // === GIT SIMULATION ===
            document.getElementById('gitPush').onclick = () => {
                const repo = document.getElementById('gitRepo').value;
                const gitLog = document.getElementById('gitLog');
                if (!repo) {
                    gitLog.innerHTML = '<div style="color:var(--error-red)">ERROR: Enter repo URL</div>';
                    return;
                }
                
                gitLog.innerHTML = '<div style="color:var(--neon-blue)">Pushing to repository...</div>';
                setTimeout(() => {
                    gitLog.innerHTML += '<div style="color:var(--success-green)">SUCCESS: Pushed to repository</div>';
                    gitLog.scrollTop = gitLog.scrollHeight;
                    addLine(`Git: Pushed to ${repo}`, 'success');
                }, 1000);
            };

            document.getElementById('gitPull').onclick = () => {
                const branch = document.getElementById('gitBranch').value;
                const gitLog = document.getElementById('gitLog');
                
                gitLog.innerHTML = `<div style="color:var(--neon-blue)">Pulling from ${branch}...</div>`;
                setTimeout(() => {
                    gitLog.innerHTML += '<div style="color:var(--success-green)">SUCCESS: Pulled latest changes</div>';
                    gitLog.scrollTop = gitLog.scrollHeight;
                    addLine(`Git: Pulled from ${branch}`, 'success');
                }, 800);
            };

            // === API WIZARD ===
            document.getElementById('connectAPI').onclick = () => {
                const url = document.getElementById('apiUrl').value;
                const key = document.getElementById('apiKey').value;
                const apiStatus = document.getElementById('apiStatus');
                if (!url || !key) {
                    apiStatus.textContent = 'Missing URL or Key';
                    apiStatus.style.color = 'var(--error-red)';
                    return;
                }
                apiStatus.textContent = 'Connecting...';
                apiStatus.style.color = 'var(--neon-blue)';
                setTimeout(() => {
                    apiStatus.textContent = 'API CONNECTED';
                    apiStatus.style.color = 'var(--success-green)';
                    addLine('API: Connected to GROKSEEK Hybrid', 'success');
                }, 1200);
            };

            // === FILE BROWSER ===
            function populateFileBrowser() {
                const fileGrid = document.getElementById('fileGrid');
                fileGrid.innerHTML = '';
                
                // Simulate X: drive contents (Arduino flash storage)
                const files = [
                    { name: 'index.html', type: 'file', size: '15.2 KB' },
                    { name: 'style.css', type: 'file', size: '8.7 KB' },
                    { name: 'script.js', type: 'file', size: '12.1 KB' },
                    { name: 'images', type: 'folder', size: '45.3 KB' },
                    { name: 'data', type: 'folder', size: '3.2 KB' },
                    { name: 'config.json', type: 'file', size: '1.1 KB' },
                    { name: 'README.md', type: 'file', size: '2.5 KB' },
                    { name: 'logs', type: 'folder', size: '7.8 KB' }
                ];
                
                files.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = `file-item ${file.type}`;
                    fileItem.innerHTML = `
                        <i class="fas fa-${file.type === 'folder' ? 'folder' : 'file'}"></i>
                        <div>${file.name}</div>
                        <div style="font-size:0.6rem;color:#888;">${file.size}</div>
                    `;
                    
                    fileItem.onclick = () => {
                        // Deselect all other files
                        document.querySelectorAll('.file-item').forEach(item => {
                            item.classList.remove('selected');
                        });
                        // Select this file
                        fileItem.classList.add('selected');
                        
                        if (file.type === 'folder') {
                            addLine(`File: Opening folder ${file.name}`, 'success');
                        } else {
                            addLine(`File: Selected ${file.name}`, 'success');
                        }
                    };
                    
                    fileItem.ondblclick = () => {
                        if (file.type === 'folder') {
                            const filePath = document.getElementById('filePath');
                            filePath.textContent = `X:\\${file.name}\\`;
                            addLine(`File: Navigated to ${file.name}`, 'success');
                        }
                    };
                    
                    fileGrid.appendChild(fileItem);
                });
            }
            
            document.getElementById('newFolder').onclick = () => {
                addLine('File: Creating new folder...', 'success');
            };
            
            document.getElementById('uploadFile').onclick = () => {
                addLine('File: Upload file dialog opened', 'success');
            };
            
            document.getElementById('deleteFile').onclick = () => {
                addLine('File: Delete selected file', 'success');
            };
            
            document.getElementById('refreshFiles').onclick = () => {
                populateFileBrowser();
                addLine('File: Refreshed file list', 'success');
            };

            // === TOUCH OPTIMIZATION ===
            document.querySelectorAll('button, .desktop-icon, .bt-device, .file-item').forEach(el => {
                el.addEventListener('touchstart', () => el.style.transform = 'scale(0.95)');
                el.addEventListener('touchend', () => el.style.transform = '');
            });

            // === INITIALIZE ===
            setTimeout(() => {
                addLine('GROKSEEK Hybrid Agent Ready. Type help.');
                addSuggestions('');
            }, 1500);
        }
    </script>
</body>
</html>
