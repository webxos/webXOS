<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>edTV: CHANNEL 10 // ASCII VR MASK</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:#000;color:#0f0;font-family:'Courier New',monospace;overflow:hidden;height:100vh;user-select:none}
  video,#ascii{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
    width:min(92vw,720px);aspect-ratio:4/3;border:6px solid #0f0;box-shadow:0 0 90px #0f0;border-radius:4px}
  #ascii{z-index:10;pointer-events:none;background:transparent}
  .banner{position:absolute;top:0;width:100%;height:50px;background:#0f0;color:#000;
    font: bold 18px 'Courier New';letter-spacing:6px;display:flex;align-items:center;justify-content:center;
    box-shadow:0 0 40px #0f0;z-index:100;animation:blink 2s infinite}
  @keyframes blink{0%,100%{opacity:1}50%{opacity:0.4}}
  .active .banner{background:#000;color:#0f0;animation:glitch .07s infinite}
  @keyframes glitch{0%{clip-path:polygon(0 0,100% 0,100% 100%,0 100%)}20%{clip-path:polygon(0 20%,100% 10%,100% 90%,0 80%)}}
  button{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);
    background:#000;color:#0f0;border:4px solid #0f0;padding:16px 40px;font:bold 18px 'Courier New';
    letter-spacing:4px;cursor:pointer;box-shadow:0 0 30px #0f0}
  button:active{background:#0f0;color:#000}
  #switch{position:absolute;top:60px;left:50%;transform:translateX(-50%);color:#0f0;font-size:14px;z-index:100}
</style>
</head>
<body>

<div class="banner">edTV: CHANNEL 10 // ASCII VR MASK</div>
<div id="switch">STYLE: 1 (click to cycle)</div>
<video id="video" autoplay playsinline muted></video>
<canvas id="ascii"></canvas>
<button id="start">ACTIVATE</button>

<script type="module">
import * as faceDetection from 'https://cdn.jsdelivr.net/npm/@tensorflow-models/face-detection@0.1.0';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/controls/OrbitControls.js';

const video = document.getElementById('video');
const canvas = document.getElementById('ascii');
const ctx = canvas.getContext('2d');
const startBtn = document.getElementById('start');
const switchEl = document.getElementById('switch');

const ASCII_CHARS = [' ', '.', ':', '-', '=', '+', '*', '#', '%', '@'];
const MASKS = [
  // 1. CLASSIC HACKER
`       ▄▄▄▄▄▄▄▄▄▄▄
     ▄█████████████▄
   ▄███▓▓▓▓▓▓▓▓▓▓▓▓██▄
  ███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
 ███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
 ███▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓███
  ███▓▓▓▓▓▓▓▓▓▓▓▓▓███
   ▀███▓▓▓▓▓▓▓▓▓███▀
     ▀████████████▀
       ▀▀▀▀▀▀▀▀▀▀▀`,

  // 2. GASMASK
`    ▓▓▓▓▓▓▓▓▓▓▓▓▓
  ▓▓▓▓████████████▓▓
 ▓▓██▓▓▓▓▓▓▓▓▓▓▓▓██▓▓
▓██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██▓
██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
 ██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
  ██▓▓▓▓▓▓▓▓▓▓▓▓▓██
   ▀▀████████████▀▀
     ▓▓▓▓▓▓▓▓▓▓▓▓`,

  // 3. DEMON GLITCH
`   ╔═╗╔═╗╔═╗╔═╗╔═╗
   ║║║║║║║║║║║║║║
   ╚╦╝╚╦╝╚╦╝╚╦╝╚╦╝
   ╔╩╗╔╩╗╔╩╗╔╩╗╔╩╗
   ╚═╝╚═╝╚═╝╚═╝╚═╝
   ╔═╗╔═╗╔═╗╔═╗╔═╗
   ║█║║█║║█║║█║║█║`,

  // 4. ANONYMOUS
`      ▄▄▀▀▀▀▀▄▄
    ▄▀  ▄▄▄▄  ▀▄
   █  ▄▀  ▀▄  ▀▄ █
  █  █ █▄█ █▄█ █  █
  █   ▀▀▀ ▀▀▀   █
   █   ▄▄▄▄▄   █
    ▀▄       ▄▀
      ▀▄▄▄▄▄▀`
];

let detector, currentMask = 0;

async function start() {
  startBtn.remove();
  document.body.classList.add('active');

  const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }});
  video.srcObject = stream;
  await video.play();

  canvas.width = video.videoWidth;
  canvas.height = video.video.height;

  detector = await faceDetection.createDetector(faceDetection.SupportedModels.BlazeFace, { maxFaces: 1 });

  // ASCII overlay loop
  function draw() {
    ctx.fillStyle = 'rgba(0,0,0,0.5)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    
    detector.detect(video).then(faces => {
      if (faces.length > 0) {
        const f = faces[0].box;
        const x = f.xMin + f.width/2 - f.width*0.8;
        const y = f.yMin + f.height/2 - f.height*0.8;
        const size = f.width * 1.7;

        const lines = MASKS[currentMask].split('\n');
        const fontSize = size / lines.length;
        ctx.font = `bold ${fontSize}px 'Courier New'`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = '#0f0';
        ctx.strokeStyle = '#000';
        ctx.lineWidth = fontSize * 0.15;

        lines.forEach((line,i) => {
          const py = y + i * fontSize;
          ctx.strokeText(line, x + size/2, py);
          ctx.fillText(line, x + size/2, py);
        });
      }
    });

    requestAnimationFrame(draw);
  }
  draw();
}

switchEl.onclick = () => {
  currentMask = (currentMask + 1) % MASKS.length;
  switchEl.textContent = `STYLE: ${currentMask + 1} (click to cycle)`;
};

startBtn.onclick = start;
</script>
</body>
</html>
